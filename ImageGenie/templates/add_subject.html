{% extends "base.html" %}

{% block title %}Add Subject - Student Result Management System{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2><i class="fas fa-plus me-2"></i>Add New Subject</h2>
        <hr>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Subject Information</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    {{ form.hidden_tag() }}
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            {{ form.code.label(class="form-label") }}
                            {{ form.code(class="form-control" + (" is-invalid" if form.code.errors else ""), placeholder="e.g., CS101, MATH201") }}
                            {% if form.code.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.code.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Unique identifier for the subject</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            {{ form.credits.label(class="form-label") }}
                            {{ form.credits(class="form-control" + (" is-invalid" if form.credits.errors else ""), placeholder="3") }}
                            {% if form.credits.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.credits.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Credit hours for this subject</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.name.label(class="form-label") }}
                        {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else ""), placeholder="e.g., Introduction to Computer Science") }}
                        {% if form.name.errors %}
                            <div class="invalid-feedback">
                                {% for error in form.name.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">Full name of the subject</div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            {{ form.department.label(class="form-label") }}
                            {{ form.department(class="form-control" + (" is-invalid" if form.department.errors else ""), placeholder="e.g., Computer Science") }}
                            {% if form.department.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.department.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Department offering this subject</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            {{ form.semester.label(class="form-label") }}
                            {{ form.semester(class="form-control" + (" is-invalid" if form.semester.errors else ""), placeholder="3") }}
                            {% if form.semester.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.semester.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-text">Recommended semester (1-8)</div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('all_subjects') }}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left me-2"></i>Back to Subjects
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Add Subject
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Help Section -->
<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Subject Guidelines</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-lightbulb me-2 text-warning"></i>Subject Code Tips:</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check text-success me-2"></i>Use department prefix (CS, MATH, ENG)</li>
                            <li><i class="fas fa-check text-success me-2"></i>Include level number (101, 201, 301)</li>
                            <li><i class="fas fa-check text-success me-2"></i>Keep it short and meaningful</li>
                            <li><i class="fas fa-times text-danger me-2"></i>Avoid special characters or spaces</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-info-circle me-2 text-info"></i>Credit System:</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-graduation-cap me-2 text-primary"></i>Theory courses: 3-4 credits</li>
                            <li><i class="fas fa-flask me-2 text-success"></i>Lab courses: 1-2 credits</li>
                            <li><i class="fas fa-project-diagram me-2 text-warning"></i>Project courses: 2-6 credits</li>
                            <li><i class="fas fa-book me-2 text-info"></i>Seminar courses: 1-2 credits</li>
                        </ul>
                    </div>
                </div>
                
                <div class="mt-3">
                    <h6><i class="fas fa-calendar me-2 text-primary"></i>Semester Guidelines:</h6>
                    <div class="row">
                        <div class="col-md-3">
                            <span class="badge bg-primary me-1">1-2</span> Foundation courses
                        </div>
                        <div class="col-md-3">
                            <span class="badge bg-success me-1">3-4</span> Core courses
                        </div>
                        <div class="col-md-3">
                            <span class="badge bg-warning me-1">5-6</span> Advanced courses
                        </div>
                        <div class="col-md-3">
                            <span class="badge bg-info me-1">7-8</span> Specialization courses
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Auto-generate subject code from name and department
document.addEventListener('DOMContentLoaded', function() {
    const nameField = document.getElementById('name');
    const deptField = document.getElementById('department');
    const codeField = document.getElementById('code');
    
    function generateCode() {
        if (!codeField.value) {
            const dept = deptField.value.substring(0, 3).toUpperCase();
            const words = nameField.value.split(' ');
            const initials = words.slice(0, 2).map(word => word.charAt(0)).join('').toUpperCase();
            const suggested = dept + initials + '01';
            
            if (suggested.length >= 4) {
                codeField.placeholder = `Suggested: ${suggested}`;
            }
        }
    }
    
    nameField.addEventListener('input', generateCode);
    deptField.addEventListener('input', generateCode);
});

// Form validation
document.querySelector('form').addEventListener('submit', function(e) {
    const code = document.getElementById('code').value.toUpperCase();
    const name = document.getElementById('name').value.trim();
    const credits = parseInt(document.getElementById('credits').value);
    
    // Basic validation
    if (code.length < 3) {
        e.preventDefault();
        alert('Subject code must be at least 3 characters long.');
        return;
    }
    
    if (name.length < 3) {
        e.preventDefault();
        alert('Subject name must be at least 3 characters long.');
        return;
    }
    
    if (credits < 1 || credits > 10) {
        e.preventDefault();
        alert('Credits must be between 1 and 10.');
        return;
    }
    
    // Convert code to uppercase
    document.getElementById('code').value = code;
});
</script>
{% endblock %}
